{% macro render_file_grid(files, filter_year=None, file_type='material') %}
<div class="row">
    {% set ns = namespace(found=false) %}
    {% for file in files %}
    {% if filter_year is none or file.year == filter_year %}
    {% set ns.found = true %}
    <div class="col-md-4 mb-4">
        <div class="card glass-effect h-100 shadow-sm animate-slide-in"
            style="animation-delay: {{ loop.index0 * 0.1 }}s;">

            {% if file_type == 'video' %}
            <div class="ratio ratio-16x9 card-img-top bg-dark rounded-top overflow-hidden">
                <video controls class="w-100 h-100">
                    <source src="{{ url_for('student.download_file', type='video', filename=file.filename) }}"
                        type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            {% endif %}

            <div class="card-body d-flex flex-column">
                <div class="d-flex justify-content-between align-items-start mb-2">
                    <h5 class="card-title text-primary mb-0">{{ file.original_name }}</h5>
                    <span class="badge bg-info">Year {{ file.year }}</span>
                </div>
                <p class="card-text text-muted small">Uploaded: {{ file.upload_date.strftime('%Y-%m-%d') }}</p>
                <div class="mt-auto">
                    <a href="{{ url_for('student.download_file', type=file_type, filename=file.filename) }}"
                        class="btn {{ 'btn-primary' if file_type == 'material' else 'btn-outline-primary' }} btn-sm w-100 hover-pulse"
                        {% if file_type=='video' %}download{% else %}target="_blank" {% endif %}>
                        {{ 'Download / View' if file_type == 'material' else 'Download Video' }}
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    {% endfor %}

    {% if not ns.found %}
    <div class="col-12">
        <div class="alert alert-secondary glass-effect">
            No {{ file_type }}s for {{ 'Year ' + filter_year if filter_year else 'this category' }} yet.
        </div>
    </div>
    {% endif %}
</div>
{% endmacro %}